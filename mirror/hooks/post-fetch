#!/bin/sh
set -eu
: "${PACK_ONE:=/mirror/pack-one.sh}"
: "${FETCH_ASSETS:=/mirror/fetch-gh-assets.sh}"

LOG_FILE="/srv/hooks/post-fetch.log"
log() { echo "[$(date --rfc-3339=seconds)]: $*" >> "$LOG_FILE"; }

log "Post-fetch execution started."

[ -x "$PACK_ONE" ] && sh "$PACK_ONE" || :

log "Pack-one execution finished."

if [ -x "$FETCH_ASSETS" ]; then
  sh "$FETCH_ASSETS" || :
  log "Fetch-gh-assets execution finished."
fi
